const explanations = [
    {
        word: "ADK",
        explanation:
          "Karteikarte aus dem Curricularen Leitfaden für die praktische Fahrausbildung" +
          " mit Inhalten zur prakti­schen Ausbildung und" +
          " Möglichkeiten der Dokumen­tation des Ausbildungsverlaufs" +
          " (Hrsg. Bundesver­Feinigung der Fahrlehrerverbände e. V.).",
      },
      {
        word: "BEDINGUNGSANALYSE",
        explanation:
          "Das Herausfinden und Bewerten der verschiedenen Ausgangsbedingungen," +
          " unter denen der Unterricht stattfindet." +
          " Damit sind in der Regel die Bedingungen gemeint," +
          " die nicht kurzfristig änderbar sind und möglicherweise zu Schwierigkeiten oder Störungen führen können.",
      },
      {
        word: "CURRICULUM",
        explanation:
          "Lehrplan, " +
          " der zusätzlich zu den Ausbildungsinhal­ten meist noch Lernziele oder Hinweise" +
          " zum Ablauf eines Lehr- oder Lernprozesses enthält," +
          " z.B. die Cur­ricularen Lehrpläne für die praktische Ausbildung diverser Fahrerlaubnisklassen," +
          " herausgegeben von der Bundesvereinigung der Fahrlehrerverbände e. V..",
      },
      {
        word: "DIDAKTIK",
        explanation: "Lehre von der Theorie und Praxis des Lehrens und Lernens.",
      },
      {
        word: "REDUKTION",
        explanation:
          "Bezeichnet Vereinfachungen und Hilfen," +
          " die das Verständnis eines komplexen Lerngegenstandes erleichtern." +
          " Dies geschieht mit Bezug auf die Fähig­keiten und Vokenntnisse der Lernenden:" +
          " DIDAKTSICHE ...",
      },
      {
        word: "TRAINING",
        explanation:
          "Beurteilen von Verkehrssituationen nach den Kate­gorien:" +
          " Alter, Absicht, Aufmerksamkeit:" +
          " DREI-A-...",
      },
      {
        word: "VERTIEFUNG",
        explanation:
          "Der Lernende setzt sich mit einem Beispiel intensiv auseinander und" +
          " erwirbt somit die Fähigkeit, Zu­sammenhänge zu erkennen und herzustellen:" +
          " EXEMPLARISCHE ...",
      },
      {
        word: "FEEDBACK",
        explanation:
          "Rückmeldung;" +
          " in Bezug auf Unterricht geht es um Rückmeldung zum Lernprozess.",
      },
      {
        word: "FLIPCHART",
        explanation:
          "Hilfsmittel in Form eines Papierständers" +
          " (meistens 70 cm x 100 cm)" +
          " für teilnehmerorientierte Lehr- und Lernprozesse.",
      },
      {
        word: "IMPROVISATION",
        explanation:
          "Abweichung vom Unterrichtskonzept oder der Unter­richtsverlaufsplanung," +
          " wenn die didaktische Situation es erfordert (z. B. Schüler haben wichtige Fragen).",
      },
    
      {
        word: "KOMPETENZEN",
        explanation:
          "Bestimmte Fähigkeiten, die vermittelt, erworben und erlernt werden können.",
      },
    
      {
        word: "LERNDIMENSION",
        explanation:
          "Ordnungssystem, in das Lernziele nach bestimmten Zusammenhängen zusammengefasst" +
          " und eingeteilt werden.",
      },
    
      {
        word: "LERNGRUPPE",
        explanation: "Oberbegriff für Klasse, Gruppe, Seminarteilnehmende",
      },
    
      {
        word: "LERNMOTIV",
        explanation: "Grund, sich etwas Neues anzueignen.",
      },
    
      {
        word: "LERNPROZESS",
        explanation:
          "Lernzuwachs, der durch verschiedene Phasen gekennzeichnet ist.",
      },
    
      {
        word: "LERNSTAND",
        explanation: "Beurteilung über den Leistungsstand eines Schülers.",
      },
    
      {
        word: "LERNSTANDSDIAGNOSE",
        explanation:
          "Beurteilung des Leistungsstands eines Schülers und" +
          " Aufzeigen weiterer Förder- und Übungsmöglich­keiten.",
      },
    
      {
        word: "LERNTYP",
        explanation:
          "In Anlehnung an die Sinnesorgane," +
          " die am Lernen beteiligt sind," +
          " werden Menschen nach Art der bevor­zugten Lernart in ... eingeteilt.",
      },
    
      {
        word: "LERNZIELE",
        explanation:
          "Affektiv: ... im Bereich von Einstellungen, Werten und Motiven." +
          " Kognitiv: ... im Bereich des Wissens über einen Gegenstand." +
          " Psychomotorisch: ... im Bereich der Bewegungsabläufe.",
      },
    
      {
        word: "LERNZIELKONTROLLE",
        explanation:
          "Verfahren, das Aufschluss über die individuellen Fähigkeiten eines Schülers gibt.",
      },
    
      {
        word: "MEDIEN",
        explanation:
          "Im pädagogischen Sinn Anschauungsmittel, Lern­hilfen." +
          " Häufig in Form von audiovisuellen ... zur Veranschaulichung von Lerngegenständen.",
      },
    
      {
        word: "METAPLANKARTEN",
        explanation:
          "Kärtchen zum Beschriften," +
          " z.B. mit Teilnehmeräuße­rungen bei der Unterrichtsmethode Moderation.",
      },
    
      {
        word: "METHODEN",
        explanation:
          "Teilgebiet der Didaktik;" +
          " Art und Weise, mit der ein Lernziel vermittelt und erreicht werden soll.",
      },
    
      {
        word: "METHODENVIELFALT",
        explanation:
          "... liegt dann vor," +
          " wenn aus dem reichhaltigen Pool verschiedene Methoden ausgewählt werden.",
      },
    
      {
        word: "MODERATION",
        explanation:
          "Gruppendynamische Methode," +
          " bei der die Gruppe, gelenkt zu Ergebnis­sen kommt.",
      },
    
      {
        word: "MOTIVATION",
        explanation:
          "Verhaltensbereitschaft:" +
          " extrinsisch: von außen kommend;" +
          " intrinsisch: von innen kommend, aus sich selbst heraus.",
      },
    
      {
        word: "Qualitätssicherung",
        explanation:
          "Verfahren, um festgelegte Standards zu überprüfen und sicherzustellen.",
      },
    
      {
        word: "SOZIALFORMEN",
        explanation:
          "Zeigen, wie und aufwelche Art" +
          " am Unterricht beteiligte Personen" +
          " zusammenarbeiten.",
      },
    
      {
        word: "TRANSFER",
        explanation:
          "Übertragung erlernter Verfahren oder Einsichten"+
          " auf eine gleichartige oder schwierige Situation.",
      },
    
      {
        word: "Unterrichtsprinzipien",
        explanation: "Richtlinien für die"+
        " Planung, Durch­führung und Beurteilung"+
        " von Unterricht.",
      },
    
      {
        word: "VISUALISIERUNG",
        explanation: "Veranschaulichung von Zahlen, Daten und Fakten"+
        " z.B. in Form von Tafelbildern oder Flip­chartblättern",
      },
    
      /*
      {
        word: "XXX",
        explanation: "",
      },
      */
    ];

let selectedExplanation;
let word;
let wrongGuesses = 0;
let correctGuesses = 0;
const maxWrongGuesses = 6;
let gameEnded = false;
let imageUpdated = false; // Flag, um zu verfolgen, ob das Bild aktualisiert wurde

function startNewGame() {
    if (correctGuesses >= 9) {
        document.getElementById("message").textContent = "Herzlichen Glückwunsch! Du hast das Spiel gewonnen!";
        document.getElementById("check-button").style.display = "none"; // Überprüfen-Button deaktivieren
        document.getElementById("start-button").style.display = "inline-block"; // Start-Knopf wieder anzeigen
        return;
    }

    // Wenn das Spiel bereits beendet ist, wird das Bild nicht zurückgesetzt
    if (!gameEnded) {
        document.getElementById("message").textContent = '';
        document.getElementById("check-button").style.display = "inline-block"; // Überprüfen-Button anzeigen
        document.getElementById("start-button").style.display = "none"; // Start-Knopf verstecken
    }

    // Setze die falschen Versuche zurück, falls das Bild aktualisiert wurde
    wrongGuesses = imageUpdated ? wrongGuesses : 0;
    imageUpdated = false; // Bildaktualisierungs-Flag zurücksetzen

    selectedExplanation = explanations[Math.floor(Math.random() * explanations.length)];
    word = selectedExplanation.word;

    document.getElementById("explanation").textContent = selectedExplanation.explanation;
    createWordGrid();
    if (!gameEnded) {
        updateHangman(); // Stelle das Bild auf den aktuellen Zustand zurück, wenn nötig
    }
}

function createWordGrid() {
    const wordGrid = document.getElementById("word-grid");
    wordGrid.innerHTML = '';

    for (let i = 0; i < word.length; i++) {
        const cell = document.createElement("div");
        cell.classList.add("letter-cell");

        const letterInput = document.createElement("input");
        letterInput.type = "text";
        letterInput.maxLength = 1;
        letterInput.oninput = (e) => {
            e.target.value = e.target.value.toUpperCase();
        };

        cell.appendChild(letterInput);
        wordGrid.appendChild(cell);
    }
}

function updateHangman() {
    if (wrongGuesses <= maxWrongGuesses) {
        const hangmanImage = document.getElementById("hangman-image");
        hangmanImage.src = `./quizze/myHangmanImages/hangman${wrongGuesses}.png`;
        imageUpdated = true; // Setze das Flag, dass das Bild aktualisiert wurde
    }
}

document.getElementById("check-button").addEventListener("click", function () {
    if (gameEnded) return; // Wenn das Spiel beendet ist, keine weiteren Aktionen zulassen

    const inputs = document.querySelectorAll(".letter-cell input");
    let guessedWord = '';

    inputs.forEach(input => {
        guessedWord += input.value.toUpperCase();
    });

    const messageElement = document.getElementById("message");

    if (guessedWord.trim() === "") {
        // Leerer Eintrag als Fehlversuch werten
        wrongGuesses++;
        updateHangman();  // Bild sofort aktualisieren
        messageElement.textContent = `Leerer Eintrag! Das gesuchte Wort war: ${word}. Noch ${maxWrongGuesses - wrongGuesses} Versuche übrig.`;
        messageElement.classList.remove("success");
        messageElement.classList.add("error");

        if (wrongGuesses >= maxWrongGuesses) {
            gameEnded = true; // Spiel beenden
            document.getElementById("check-button").style.display = "none"; // Überprüfen-Button deaktivieren
            setTimeout(() => {
                document.getElementById("start-button").style.display = "inline-block"; // Start-Knopf wieder anzeigen
            }, 2000);
        }
    } else if (guessedWord === word) {
        // Richtiges Wort erraten
        correctGuesses++;
        if (correctGuesses >= 9) {
            messageElement.textContent = "Herzlichen Glückwunsch! Du hast das Spiel gewonnen!";
            messageElement.classList.remove("error");
            messageElement.classList.add("success");
            document.getElementById("check-button").style.display = "none"; // Überprüfen-Button deaktivieren
            document.getElementById("start-button").style.display = "inline-block"; // Start-Knopf wieder anzeigen
            // Bild bleibt unverändert nach richtiger Eingabe
            return;
        } else {
            messageElement.textContent = `Glückwunsch! Du hast das Wort richtig erraten. Noch ${9 - correctGuesses} Wörter bis zum Sieg.`;
            messageElement.classList.remove("error");
            messageElement.classList.add("success");
            setTimeout(startNewGame, 2000);  // Neues Spiel nach 2 Sekunden starten
        }
    } else {
        // Falsches Wort erraten
        wrongGuesses++;
        updateHangman();  // Bild sofort aktualisieren
        messageElement.textContent = `Falsch! Noch ${maxWrongGuesses - wrongGuesses} Versuche übrig.`;
        messageElement.classList.remove("success");
        messageElement.classList.add("error");

        if (wrongGuesses >= maxWrongGuesses) {
            messageElement.textContent += ` Das Spiel ist vorbei! Das gesuchte Wort war: ${word}.`;
            gameEnded = true; // Spiel beenden
            document.getElementById("check-button").style.display = "none"; // Überprüfen-Button deaktivieren
            setTimeout(() => {
                document.getElementById("start-button").style.display = "inline-block"; // Start-Knopf wieder anzeigen
            }, 2000);
        }
    }
});

document.getElementById("start-button").addEventListener("click", function () {
    correctGuesses = 0; // Korrekte Versuche zurücksetzen
    wrongGuesses = 0; // Falsche Versuche zurücksetzen
    gameEnded = false; // Spielstatus zurücksetzen
    imageUpdated = false; // Bildaktualisierungs-Flag zurücksetzen
    this.style.display = "none"; // Start-Knopf verstecken
    startNewGame();
});

// Funktion für den "Zurück"-Link
document.getElementById("back-link").addEventListener("click", function (e) {
    e.preventDefault();
    window.history.back(); // Gehe zur vorherigen Seite zurück
});
